# NeoVM 指令集

## 概述

NeoVM 使用超过 200 个操作码的丰富指令集。指令按功能分类。

## 指令分类

1. 常量操作
2. 流程控制
3. 栈操作
4. 槽位操作
5. 字符串操作
6. 逻辑操作
7. 算术操作
8. 复合类型操作
9. 类型操作

## 1. 常量操作

将常量值压入栈：

| 操作码 | 名称 | 描述 |
|--------|------|------|
| 0x00 | PUSHINT8 | 压入 1 字节有符号整数 |
| 0x01 | PUSHINT16 | 压入 2 字节有符号整数 |
| 0x02 | PUSHINT32 | 压入 4 字节有符号整数 |
| 0x03 | PUSHINT64 | 压入 8 字节有符号整数 |
| 0x04 | PUSHINT128 | 压入 16 字节有符号整数 |
| 0x05 | PUSHINT256 | 压入 32 字节有符号整数 |
| 0x08 | PUSHT | 压入 true |
| 0x09 | PUSHF | 压入 false |
| 0x0B | PUSHNULL | 压入 null |

## 2. 流程控制

控制程序执行流程：

| 操作码 | 名称 | 描述 |
|--------|------|------|
| 0x20 | JMP | 无条件跳转 |
| 0x21 | JMP_L | 长无条件跳转 |
| 0x22 | JMPIF | 为真时跳转 |
| 0x23 | JMPIF_L | 长为真跳转 |
| 0x24 | JMPIFNOT | 为假时跳转 |
| 0x25 | JMPIFNOT_L | 长为假跳转 |
| 0x26 | JMPEQ | 相等时跳转 |
| 0x27 | JMPEQ_L | 长相等跳转 |
| 0x34 | CALL | 调用函数 |
| 0x35 | CALL_L | 长调用 |
| 0x40 | RET | 从函数返回 |

## 3. 栈操作

操作计算栈：

| 操作码 | 名称 | 描述 |
|--------|------|------|
| 0x45 | DEPTH | 获取栈深度 |
| 0x46 | DROP | 移除栈顶项 |
| 0x47 | NIP | 移除第二项 |
| 0x48 | XDROP | 移除指定索引项 |
| 0x49 | CLEAR | 清空栈 |
| 0x4A | DUP | 复制栈顶项 |
| 0x4B | OVER | 复制第二项到栈顶 |
| 0x4D | SWAP | 交换栈顶两项 |
| 0x4E | ROT | 旋转栈顶三项 |
| 0x50 | REVERSE3 | 反转栈顶 3 项 |
| 0x51 | REVERSE4 | 反转栈顶 4 项 |

## 4. 算术操作

数学运算：

| 操作码 | 名称 | 描述 |
|--------|------|------|
| 0x8B | SIGN | 获取数字符号 |
| 0x8C | ABS | 绝对值 |
| 0x8D | NEGATE | 取反 |
| 0x8E | INC | 加 1 |
| 0x8F | DEC | 减 1 |
| 0x90 | ADD | 加法 |
| 0x91 | SUB | 减法 |
| 0x92 | MUL | 乘法 |
| 0x93 | DIV | 除法 |
| 0x94 | MOD | 取模 |
| 0x95 | POW | 幂运算 |
| 0x96 | SQRT | 平方根 |

## 5. 逻辑操作

| 操作码 | 名称 | 描述 |
|--------|------|------|
| 0xA8 | NOT | 逻辑非 |
| 0xA9 | AND | 按位与 |
| 0xAA | OR | 按位或 |
| 0xAB | XOR | 按位异或 |
| 0xB1 | EQUAL | 检查相等 |
| 0xB2 | NOTEQUAL | 检查不等 |

## 6. 比较操作

| 操作码 | 名称 | 描述 |
|--------|------|------|
| 0xB3 | LT | 小于 |
| 0xB4 | LE | 小于等于 |
| 0xB5 | GT | 大于 |
| 0xB6 | GE | 大于等于 |

## 示例：简单加法

```
PUSHINT8 5    // 压入 5
PUSHINT8 3    // 压入 3
ADD           // 结果: 8
```
